/*!
 * Dragster - drag'n'drop library v1.0.5
 * https://github.com/sunpietro/dragster
 *
 * Copyright 2015 Piotr Nalepa
 * http://blog.piotrnalepa.pl
 *
 * Released under the MIT license
 * https://github.com/sunpietro/dragster/blob/master/LICENSE
 *
 * Date: 2015-05-21T19:00Z
 */
(function(e,t){e.Dragster=function(e){var n="is-dragging",s="is-drag-over",i="dragster-draggable",r="dragster-drag-region",a="dragster-drop-placeholder",o="dragster-temp",l="dragster-temp-container",c="dragster-is-hidden",d="dragster-replacable",u={elementSelector:".dragster-block",regionSelector:".dragster-region",replaceElements:false},f="draggable",m="data-placeholder-position",p={top:false,bottom:false},g,v,h,L,E,y,C,b,w,B,N,T,A,H,M,S,x,D,O,R,X,Y,q;for(g in e){if(e.hasOwnProperty(g)){u[g]=e[g]}}Y=function(){return Array.prototype.slice.call(t.querySelectorAll(u.elementSelector))};q=function(e){e.forEach(function(e){var t=M(),n=e.parentNode;if(n.classList.contains(i)){return}n.insertBefore(t,e);n.removeChild(e);t.appendChild(e)})};b=Y();v=Array.prototype.slice.call(t.querySelectorAll(u.regionSelector));if(u.replaceElements){y=t.createElement("div");y.classList.add(c);y.classList.add(l);t.body.appendChild(y)}h=function(e,t){var n=e.parentNode;if(!n||e.classList&&e.classList.contains(r)){return undefined}if(t(e)){return e}return t(n)?n:h(n,t)};O=function(e){var n=Array.prototype.slice.call(t.getElementsByClassName(e));n.forEach(function(e){e.parentNode.removeChild(e)})};R=function(e,s){v.forEach(function(e){e.removeEventListener(s,w.mousemove)});t.body.removeEventListener(s,w.mousemove);if(e){e.classList.remove(n)}O(a);O(o)};X=function(){Array.prototype.slice.call(t.getElementsByClassName(d)).forEach(function(e){e.classList.remove(d)})};M=function(){var e=t.createElement("div");e.setAttribute(f,true);e.classList.add(i);return e};x=function(){var e=t.createElement("div");e.classList.add(a);return e};S=function(){var e=t.createElement("div");e.classList.add(o);e.classList.add(c);t.body.appendChild(e);return e};A=function(e,t){e.parentNode.insertBefore(t,e.nextSibling)};H=function(e,t){e.parentNode.insertBefore(t,e)};T=function(e){return e.classList&&e.classList.contains(r)};N=function(e){return e.classList&&e.classList.contains(i)};B=function(e){return e.classList&&e.classList.contains(a)};w={mousedown:function(e){e.preventDefault();if(e.which===3){return false}var s,i=e.type==="touchstart"?"touchmove":"mousemove";v.forEach(function(e){e.addEventListener(i,w.mousemove)});t.body.addEventListener(i,w.mousemove);C=h(e.target,N);if(!C){return false}s=C.getBoundingClientRect();L=S();L.innerHTML=C.innerHTML;L.style.width=s.width+"px";L.style.height=s.height+"px";E=L.getBoundingClientRect();C.classList.add(n)},mousemove:function(e){e.preventDefault();var n=e.changedTouches?e.changedTouches[0]:e,s=n.view?n.view.pageXOffset:0,o=n.view?n.view.pageYOffset:0,l=n.clientY+o,f=n.clientX+s,g=t.elementFromPoint(n.clientX,n.clientY),v=h(g,N),y,b,w;clearTimeout(D);L.style.top=l+25+"px";L.style.left=f-E.width/2+"px";L.classList.remove(c);if(v&&v!==C){w=x();y=v.getBoundingClientRect();b=y.height/2;X();if(!u.replaceElements){if(l-y.top<b&&!p.top){O(a);w.setAttribute(m,"top");H(v.firstChild,w)}else if(y.bottom-l<b&&!p.bottom){O(a);w.setAttribute(m,"bottom");v.appendChild(w)}}else{v.classList.add(d)}}else if(g.classList.contains(r)&&g.getElementsByClassName(i).length===0&&g.getElementsByClassName(a).length===0){w=x();g.appendChild(w)}else if(g.classList.contains(r)&&g.getElementsByClassName(i).length>0&&g.getElementsByClassName(a).length===0){var B=g.getElementsByClassName(i);w=x();w.setAttribute(m,"bottom");O(a);B[B.length-1].appendChild(w)}else if(!g.classList.contains(r)){if(!u.replaceElements){O(a)}else{X()}}},mouseup:function(e){var n=u.replaceElements?d:a,i=t.getElementsByClassName(n)[0],r,o,c=e.type==="touchstart"?"touchmove":"mousemove",f;D=setTimeout(function(){R(C,c)},200);X();if(!C||!i){R(C,c);return false}r=h(i,N);r=r||i;if(C!==r){if(!u.replaceElements){f=M();o=i.getAttribute(m);if(o==="top"){H(r,f)}else{A(r,f)}f.appendChild(C.firstChild)}else{f=t.getElementsByClassName(l)[0];f.innerHTML=C.innerHTML;C.innerHTML=r.innerHTML;r.innerHTML=f.innerHTML;f.innerHTML=""}r.classList.remove(s)}R(C,c)}};q(b);t.body.addEventListener("mouseup",w.mouseup,false);t.body.addEventListener("touchend",w.mouseup,false);v.forEach(function(e){e.classList.add(r);e.addEventListener("mousedown",w.mousedown,false);e.addEventListener("mouseup",w.mouseup,false);e.addEventListener("touchstart",w.mousedown,false);e.addEventListener("touchend",w.mouseup,false)});return{update:function(){q(Y())}}}})(window,window.document);
